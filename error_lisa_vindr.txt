
CondaError: Run 'conda init' before 'conda activate'

wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: tuandung2812alt1 (tuandung2812alt1-hanoi-university-of-science-and-technology). Use `wandb login --relogin` to force relogin
wandb: Appending key for api.wandb.ai to your netrc file: /home/user01/.netrc
wandb: Tracking run with wandb version 0.18.0
wandb: Run data is saved locally in /home/user01/aiotlab/dung_paper/groundingLMM/LISAMed/wandb/run-20241016_091732-zvi1lpij
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run text_only_medsam_vindr_llavamed_bs_16_lr_5e-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/tuandung2812alt1-hanoi-university-of-science-and-technology/VinDr%20VQA%20-%20Debug
wandb: üöÄ View run at https://wandb.ai/tuandung2812alt1-hanoi-university-of-science-and-technology/VinDr%20VQA%20-%20Debug/runs/zvi1lpij
Loading checkpoint shards:   0%|                                                    | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                 | 1/4 [00:00<00:00,  8.96it/s]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                      | 2/4 [00:00<00:00,  9.49it/s]Loading checkpoint shards:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà           | 3/4 [00:00<00:00,  9.16it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  9.57it/s]
Using /home/user01/.cache/torch_extensions/py310_cu117 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/user01/.cache/torch_extensions/py310_cu117/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Loading extension module fused_adam...
[W CUDAGuardImpl.h:46] Warning: CUDA warning: CUDA driver version is insufficient for CUDA runtime version (function uncheckedGetDevice)
[W CUDAGuardImpl.h:62] Warning: CUDA warning: CUDA driver version is insufficient for CUDA runtime version (function uncheckedSetDevice)
  0%|                                                                               | 0/2 [00:00<?, ?it/s]  0%|                                                                               | 0/2 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "/home/user01/aiotlab/dung_paper/groundingLMM/LISAMed/train_text.py", line 500, in train
    input_dict = next(train_iter)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/deepspeed/runtime/dataloader.py", line 124, in __next__
    return next(self.data)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/deepspeed/runtime/dataloader.py", line 157, in <genexpr>
    self.data = (x for x in self.dataloader)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/user01/aiotlab/dung_paper/groundingLMM/LISAMed/utils/dataset.py", line 155, in collate_fn
    print('collate input_ids: ', tokenizer.decode(input_ids))
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 4007, in decode
    return self._decode(
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 1088, in _decode
    filtered_tokens = self.convert_ids_to_tokens(token_ids, skip_special_tokens=skip_special_tokens)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 1063, in convert_ids_to_tokens
    index = int(index)
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'list'


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/user01/aiotlab/dung_paper/groundingLMM/LISAMed/train_text.py", line 711, in <module>
    main(sys.argv[1:])
  File "/home/user01/aiotlab/dung_paper/groundingLMM/LISAMed/train_text.py", line 427, in main
    train_iter = train(
  File "/home/user01/aiotlab/dung_paper/groundingLMM/LISAMed/train_text.py", line 503, in train
    input_dict = next(train_iter)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/deepspeed/runtime/dataloader.py", line 124, in __next__
    return next(self.data)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/deepspeed/runtime/dataloader.py", line 157, in <genexpr>
    self.data = (x for x in self.dataloader)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/user01/aiotlab/dung_paper/groundingLMM/LISAMed/train_text.py", line 500, in train
    input_dict = next(train_iter)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/deepspeed/runtime/dataloader.py", line 124, in __next__
    return next(self.data)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/deepspeed/runtime/dataloader.py", line 157, in <genexpr>
    self.data = (x for x in self.dataloader)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/user01/aiotlab/dung_paper/groundingLMM/LISAMed/utils/dataset.py", line 155, in collate_fn
    print('collate input_ids: ', tokenizer.decode(input_ids))
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 4007, in decode
    return self._decode(
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 1088, in _decode
    filtered_tokens = self.convert_ids_to_tokens(token_ids, skip_special_tokens=skip_special_tokens)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 1063, in convert_ids_to_tokens
    index = int(index)
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'list'


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/user01/aiotlab/dung_paper/groundingLMM/LISAMed/utils/dataset.py", line 155, in collate_fn
    print('collate input_ids: ', tokenizer.decode(input_ids))
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 4007, in decode
    return self._decode(
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 1088, in _decode
    filtered_tokens = self.convert_ids_to_tokens(token_ids, skip_special_tokens=skip_special_tokens)
  File "/home/user01/miniconda3/envs/glamm_2/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 1063, in convert_ids_to_tokens
    index = int(index)
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'list'

